\doxysection{esp3/\+esp3.ino File Reference}
\hypertarget{esp3_8ino}{}\label{esp3_8ino}\index{esp3/esp3.ino@{esp3/esp3.ino}}


Door actuator, buzzer, and LED controller with MQTT integration.  


{\ttfamily \+\#include $<$Servo.\+h$>$}\newline
{\ttfamily \+\#include $<$Arduino\+Json.\+h$>$}\newline
{\ttfamily \+\#include $<$Wi\+Fi\+Mqtt\+Client.\+h$>$}\newline
Include dependency graph for esp3.\+ino:\+\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{esp3_8ino__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \doxymbox{\hyperlink{structBuzzerPattern}{Buzzer\+Pattern}}
\begin{DoxyCompactList}\small\item\em Describes a buzzer sound pattern. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{group__esp3_gaae89f73e4cdcb650ae5c585818d3a861}{POT\+\_\+\+PIN}}~A0
\begin{DoxyCompactList}\small\item\em Analog pin for potentiometer (admin servo control). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum class \doxymbox{\hyperlink{group__esp3_ga6a8b3b75b2ade421c119d83a8b2133f1}{Access\+Result}} :\+ uint8\+\_\+t \{ \doxymbox{\hyperlink{group__esp3_gga6a8b3b75b2ade421c119d83a8b2133f1a58d036b9b7f0e7eb38cfb90f1cc70a73}{Access\+Result::\+\+Denied}}
, \doxymbox{\hyperlink{group__esp3_gga6a8b3b75b2ade421c119d83a8b2133f1ac322f9346b70efdd31968628d5ee68db}{Access\+Result::\+\+Granted}}
, \doxymbox{\hyperlink{group__esp3_gga6a8b3b75b2ade421c119d83a8b2133f1a58d036b9b7f0e7eb38cfb90f1cc70a73}{Access\+Result::\+\+Denied}}
, \doxymbox{\hyperlink{group__esp3_gga6a8b3b75b2ade421c119d83a8b2133f1ac322f9346b70efdd31968628d5ee68db}{Access\+Result::\+\+Granted}}
 \}
\begin{DoxyCompactList}\small\item\em Access result enumeration. \end{DoxyCompactList}\item 
enum \doxymbox{\hyperlink{group__esp3_gae3c5be103282ee46f635819ae28c1176}{Buzzer\+State}} \{ \doxymbox{\hyperlink{group__esp3_ggae3c5be103282ee46f635819ae28c1176ad32089a6564a38159e66921ddece6ebd}{BUZZER\+\_\+\+IDLE}}
, \doxymbox{\hyperlink{group__esp3_ggae3c5be103282ee46f635819ae28c1176a5435ccab40fb29ad3420e7ffdecac65c}{BUZZER\+\_\+\+ON}}
, \doxymbox{\hyperlink{group__esp3_ggae3c5be103282ee46f635819ae28c1176a6fd00a9b64a658134b21162400027a68}{BUZZER\+\_\+\+OFF}}
 \}
\begin{DoxyCompactList}\small\item\em Buzzer state enumeration. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \doxymbox{\hyperlink{group__esp3_ga89ff5d59e14a11256f4dd5c82602f932}{play\+Pattern}} (const unsigned int \texorpdfstring{$\ast$}{*}timings, uint8\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Starts playing a buzzer pattern. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga312e25f84437a687662bb53eceebec83}{update\+Buzzer}} ()
\begin{DoxyCompactList}\small\item\em Advances the buzzer state machine. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga95513a5e9cc3b574afa284a38c77d6e7}{stop\+Buzzer}} ()
\begin{DoxyCompactList}\small\item\em Immediately stops any active buzzer sound. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga4da2553f00d22f892f2fe8ee47e9db9f}{play\+Lock\+Sound}} ()
\begin{DoxyCompactList}\small\item\em Plays lock sound pattern. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga979598b64139705fd13eb4ea50e0674c}{play\+Unlock\+Sound}} ()
\begin{DoxyCompactList}\small\item\em Plays unlock sound pattern. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga04bf0803eb139c30e08775daa9076ea6}{play\+Denied\+Sound}} ()
\begin{DoxyCompactList}\small\item\em Plays denied-\/access sound pattern. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga0f76dd1d3c15f21fc5dd0d4536f4c100}{play\+Tap\+Sound}} ()
\begin{DoxyCompactList}\small\item\em Plays keypad tap sound. \end{DoxyCompactList}\item 
static void \doxymbox{\hyperlink{group__esp3_gaff8c04e7b324ff4272911924db174640}{force\+Lock}} ()
\begin{DoxyCompactList}\small\item\em Forces the system into a locked idle state. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_gac3a129f66dc859e2b7279565f4e1de78}{callback}} (char \texorpdfstring{$\ast$}{*}topic, byte \texorpdfstring{$\ast$}{*}payload, unsigned int length)
\begin{DoxyCompactList}\small\item\em MQTT message callback handler. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_ga4fc01d736fe50cf5b977f755b675f11d}{setup}} ()
\begin{DoxyCompactList}\small\item\em Arduino setup function. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{group__esp3_gafe461d27b9c48d5921c00d521181f12f}{loop}} ()
\begin{DoxyCompactList}\small\item\em Arduino main loop. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\doxymbox{\hyperlink{classWifiMqttClient}{Wifi\+Mqtt\+Client}} \doxymbox{\hyperlink{group__esp3_ga082cbde9dbf32731aabec6f0b8a7e5c0}{net}}
\begin{DoxyCompactList}\small\item\em Wi\+Fi + MQTT client wrapper. \end{DoxyCompactList}\item 
constexpr char \doxymbox{\hyperlink{group__esp3_gae4ee394ecd24781bba5d0aaaab8e964a}{WIFI\+\_\+\+SSID}} \+[$\,$]\+ = "{}Mathias2.\+4"{}
\begin{DoxyCompactList}\small\item\em Wi\+Fi SSID. \end{DoxyCompactList}\item 
constexpr char \doxymbox{\hyperlink{group__esp3_ga0495958e0c537c1c5100ee272495435c}{WIFI\+\_\+\+PASS}} \+[$\,$]\+ = "{}mrbombasticcallmefantastic"{}
\begin{DoxyCompactList}\small\item\em Wi\+Fi password. \end{DoxyCompactList}\item 
constexpr char \doxymbox{\hyperlink{group__esp3_ga41c34e432b12a511f9348547ddae11d4}{MQTT\+\_\+\+HOST}} \+[$\,$]\+ = "{}maqiatto.\+com"{}
\begin{DoxyCompactList}\small\item\em MQTT broker hostname. \end{DoxyCompactList}\item 
constexpr uint16\+\_\+t \doxymbox{\hyperlink{group__esp3_ga993a7e0c0377e10146438ebe707f31d0}{MQTT\+\_\+\+PORT}} = 1883
\begin{DoxyCompactList}\small\item\em MQTT broker port. \end{DoxyCompactList}\item 
constexpr char \doxymbox{\hyperlink{group__esp3_ga315cd313c3f6301b48d2f67e63bec2db}{MQTT\+\_\+\+USER}} \+[$\,$]\+ = "{}hectorfoss@gmail.\+com"{}
\begin{DoxyCompactList}\small\item\em MQTT username. \end{DoxyCompactList}\item 
constexpr char \doxymbox{\hyperlink{group__esp3_ga31dacdc924feb376b49448eb843d053c}{MQTT\+\_\+\+PASS}} \+[$\,$]\+ = "{}potter"{}
\begin{DoxyCompactList}\small\item\em MQTT password. \end{DoxyCompactList}\item 
constexpr char \doxymbox{\hyperlink{group__esp3_ga04ecc29c762e5b2844d3c24744813015}{DEVICE\+\_\+\+ID}} \+[$\,$]\+ = "{}door1"{}
\begin{DoxyCompactList}\small\item\em Unique device identifier used in MQTT topics. \end{DoxyCompactList}\item 
constexpr uint8\+\_\+t \doxymbox{\hyperlink{group__esp3_ga1ff3e63b5caeb625ff113a8190b24c80}{RED\+\_\+\+PIN}} = 4
\begin{DoxyCompactList}\small\item\em GPIO pin assignments. \end{DoxyCompactList}\item 
constexpr uint8\+\_\+t \doxymbox{\hyperlink{group__esp3_gad779a2a8a81b39a265a6361f7edf06f2}{GREEN\+\_\+\+PIN}} = 0
\item 
constexpr uint8\+\_\+t \doxymbox{\hyperlink{group__esp3_gafbe2629cea08969000cef8d30978edd8}{BUZZER\+\_\+\+PIN}} = 14
\item 
constexpr uint8\+\_\+t \doxymbox{\hyperlink{group__esp3_ga98714b3ea5db9fa78cbcf8891a3c0798}{SERVO\+\_\+\+PIN}} = 13
\item 
constexpr uint32\+\_\+t \doxymbox{\hyperlink{group__esp3_ga6d6d37a1e68b6dcd10e646ed685f6f5e}{UNLOCK\+\_\+\+TIME\+\_\+\+MS}} = 5000
\begin{DoxyCompactList}\small\item\em Door unlock duration (ms). \end{DoxyCompactList}\item 
uint32\+\_\+t \doxymbox{\hyperlink{group__esp3_ga744e7cb284580272a7afb8a81f2a3bba}{unlock\+Until}} = 0
\begin{DoxyCompactList}\small\item\em Timestamp (ms) until which the door remains unlocked. \end{DoxyCompactList}\item 
bool \doxymbox{\hyperlink{group__esp3_ga5284d36e95aca49afcb3ae1ecc97add5}{unlocked}} = false
\begin{DoxyCompactList}\small\item\em Indicates whether the door is currently unlocked. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{group__esp1_ga6a8b3b75b2ade421c119d83a8b2133f1}{Access\+Result}} \doxymbox{\hyperlink{group__esp3_ga39d1ef76cb1d31fc16d855c63df5624a}{access\+Granted}}
\begin{DoxyCompactList}\small\item\em Result of keypad PIN verification. \end{DoxyCompactList}\item 
bool \doxymbox{\hyperlink{group__esp3_ga037a56ba222296920d6e0f06796e9f21}{rfid\+Access}} = false
\begin{DoxyCompactList}\small\item\em Indicates whether RFID access was granted. \end{DoxyCompactList}\item 
Servo \doxymbox{\hyperlink{group__esp3_ga7d2ca4784fdea2b5e9ac6f9ac738ef08}{lock\+\_\+servo}}
\begin{DoxyCompactList}\small\item\em Servo instance controlling the lock mechanism. \end{DoxyCompactList}\item 
bool \doxymbox{\hyperlink{group__esp3_gac981a10fb220aee90291389b2607c637}{servo\+Open}} = false
\begin{DoxyCompactList}\small\item\em Indicates whether the servo is currently in the open position. \end{DoxyCompactList}\item 
uint8\+\_\+t \doxymbox{\hyperlink{group__esp3_ga9382f70e6b3786d1e4c31a325939561e}{servo\+Angle}}
\begin{DoxyCompactList}\small\item\em Current servo angle (derived from potentiometer in admin mode). \end{DoxyCompactList}\item 
bool \doxymbox{\hyperlink{group__esp3_gacb368e6741d7e5d5fb51f384f3ef6c5e}{admin\+Servo\+Control}} = false
\begin{DoxyCompactList}\small\item\em Enables direct servo control via potentiometer (admin mode). \end{DoxyCompactList}\item 
const unsigned int \doxymbox{\hyperlink{group__esp3_ga2bba129d79cf6951bff6c7931dee6f03}{denied\+Timings}} \+[$\,$]\+
\begin{DoxyCompactList}\small\item\em Denied access:\+ single long beep. Extra long to scare. \end{DoxyCompactList}\item 
const unsigned int \doxymbox{\hyperlink{group__esp3_ga7dafde6b11d0e61269d5b5326deee7cb}{lock\+Timings}} \+[$\,$]\+
\begin{DoxyCompactList}\small\item\em Lock sound:\+ long-\/long-\/long pattern. \end{DoxyCompactList}\item 
const unsigned int \doxymbox{\hyperlink{group__esp3_gaf8884950ef523ca854f256d016cfaf29}{unlock\+Timings}} \+[$\,$]\+
\begin{DoxyCompactList}\small\item\em Unlock sound:\+ short-\/short pattern. \end{DoxyCompactList}\item 
const unsigned int \doxymbox{\hyperlink{group__esp3_gacf6a49719a118eac7c9f54b4351977fd}{beep\+Timings}} \+[$\,$]\+
\begin{DoxyCompactList}\small\item\em Keypad tap sound:\+ short beep. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{group__esp3_gae3c5be103282ee46f635819ae28c1176}{Buzzer\+State}} \doxymbox{\hyperlink{group__esp3_ga83ec3e49d3b2d7a5b3d7e24776ed94dd}{buzzer\+State}} = \doxymbox{\hyperlink{group__esp3_ggae3c5be103282ee46f635819ae28c1176ad32089a6564a38159e66921ddece6ebd}{BUZZER\+\_\+\+IDLE}}
\begin{DoxyCompactList}\small\item\em Current buzzer state. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{structBuzzerPattern}{Buzzer\+Pattern}} \doxymbox{\hyperlink{group__esp3_ga3968694cac10b831396197bf7627d45c}{current\+Pattern}} = \{nullptr, 0\}
\begin{DoxyCompactList}\small\item\em Currently active buzzer pattern. \end{DoxyCompactList}\item 
uint8\+\_\+t \doxymbox{\hyperlink{group__esp3_gad0d2a31b1a102cbb8a415773c47b01bb}{step\+Index}} = 0
\begin{DoxyCompactList}\small\item\em Index into the timing array. \end{DoxyCompactList}\item 
unsigned long \doxymbox{\hyperlink{group__esp3_gaeaa41d0f25d6ba9737d73ffa5136f4ab}{last\+Change}} = 0
\begin{DoxyCompactList}\small\item\em Timestamp of last buzzer state change. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Door actuator, buzzer, and LED controller with MQTT integration. 



Definition in file \doxymbox{\hyperlink{esp3_8ino_source}{esp3.\+ino}}.

